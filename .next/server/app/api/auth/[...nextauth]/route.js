(()=>{var e={};e.id=1014,e.ids=[1014],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},87550:e=>{"use strict";e.exports=require("better-sqlite3")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},55511:e=>{"use strict";e.exports=require("crypto")},33873:e=>{"use strict";e.exports=require("path")},27039:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>h,routeModule:()=>l,serverHooks:()=>c,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>p});var s={};r.r(s),r.d(s,{GET:()=>o,POST:()=>u});var a=r(42706),i=r(28203),n=r(45994);let{GET:o,POST:u}=r(60809).Y9,l=new a.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/auth/[...nextauth]/route",pathname:"/api/auth/[...nextauth]",filename:"route",bundlePath:"app/api/auth/[...nextauth]/route"},resolvedPagePath:"/home/runner/work/PartFiles/PartFiles/src/app/api/auth/[...nextauth]/route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:d,workUnitAsyncStorage:p,serverHooks:c}=l;function h(){return(0,n.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:p})}},96487:()=>{},78335:()=>{},42706:(e,t,r)=>{"use strict";e.exports=r(44870)},60809:(e,t,r)=>{"use strict";r.d(t,{j2:()=>w,Y9:()=>p});var s=r(57971),a=r(23352),i=r(34926),n=r(84908);let o={pages:{signIn:"/login"},callbacks:{jwt:async({token:e,user:t})=>(t&&(e.id=t.id,e.role=t.role),e),session:async({session:e,token:t})=>(e.user&&(e.user.id=t.id,e.user.role=t.role),e),authorized({auth:e,request:{nextUrl:t,headers:r}}){let s=e?.user?.role,a=!!e?.user&&!!s,i=t.pathname;if(i.startsWith("/login")||i.startsWith("/invite")||i.startsWith("/api/auth")||i.startsWith("/api/invite")||i.startsWith("/api/preview")||/^(\/api\/content\/[^/]+(\/raw)?)$/.test(i)||/^(\/(c|r|s|e)\/[^/]+)$/.test(i)||i.startsWith("/api/cron"))return!0;let n=function(e,t){let r=t.get("x-forwarded-host"),s=t.get("x-forwarded-proto")||"https";return r?`${s}://${r}`:e.origin}(t,r);if(!a){if(r.get("x-forwarded-host")){let e=new URL("/login",n);return e.searchParams.set("callbackUrl",t.pathname+t.search),Response.redirect(e)}return!1}return!((i.startsWith("/admin")||i.startsWith("/api/admin"))&&"admin"!==s||("/upload"===i||i.startsWith("/api/upload"))&&"admin"!==s&&"uploader"!==s)||Response.redirect(new URL("/dashboard",n))}},providers:[],session:{strategy:"jwt"}},u=new Map,l=Date.now();function d(){let e=Date.now();if(!(e-l<3e5))for(let[t,r]of(l=e,u))e>r.resetAt&&u.delete(t)}let{handlers:p,signIn:c,signOut:h,auth:w}=(0,s.Ay)({...o,callbacks:{...o.callbacks,async jwt({token:e,user:t}){if(t)return e.id=t.id,e.role=t.role,e.revalidatedAt=Date.now(),e;let r=e.revalidatedAt??0;if(Date.now()-r>3e5){let t=await n.z.user.findUnique({where:{id:e.id},select:{id:!0,role:!0}});if(!t)return e.id=void 0,e.role=void 0,e.revalidatedAt=void 0,e;e.role=t.role,e.revalidatedAt=Date.now()}return e}},providers:[(0,a.A)({name:"credentials",credentials:{username:{label:"Username",type:"text"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.username||!e?.password)return null;let t=e.username.toLowerCase(),r=e.password;if(function(e){d();let t=Date.now(),r=u.get(e);return!!r&&!(t>r.resetAt)&&r.failures>=5}(t))return null;let s=await n.z.user.findUnique({where:{username:t}});return s&&(0,i.Dm)(r,s.passwordHash)?(u.delete(t),{id:s.id,name:s.username,role:s.role}):(function(e){d();let t=Date.now(),r=u.get(e);!r||t>r.resetAt?u.set(e,{failures:1,resetAt:t+9e5}):(r.failures++,r.failures)}(t),null)}})]})},84908:(e,t,r)=>{"use strict";r.d(t,{z:()=>o});var s=r(96330),a=r(64981),i=r(33873),n=r.n(i);let o=globalThis.prisma??function(){let e=function(){let e=process.env.DATABASE_URL||"file:./dev.db";if(e.startsWith("file:")){let t=e.slice(5),r=n().resolve(process.cwd(),t);return`file:${r}`}return e}(),t=new a.C({url:e});return new s.PrismaClient({adapter:t})}()}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[638,9187,4981,4926,2787,5522],()=>r(27039));module.exports=s})();