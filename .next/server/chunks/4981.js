"use strict";exports.id=4981,exports.ids=[4981],exports.modules={64981:(e,t,r)=>{r.d(t,{C:()=>eu});var n,i,s,a,o=Object.defineProperty,l={};((e,t)=>{for(var r in t)o(e,r,{get:t[r],enumerable:!0})})(l,{$:()=>c,bgBlack:()=>S,bgBlue:()=>C,bgCyan:()=>U,bgGreen:()=>A,bgMagenta:()=>L,bgRed:()=>D,bgWhite:()=>q,bgYellow:()=>B,black:()=>v,blue:()=>_,bold:()=>m,cyan:()=>x,dim:()=>d,gray:()=>O,green:()=>b,grey:()=>k,hidden:()=>w,inverse:()=>y,italic:()=>f,magenta:()=>N,red:()=>T,reset:()=>p,strikethrough:()=>E,underline:()=>g,white:()=>R,yellow:()=>I});var u=!0;"undefined"!=typeof process&&({FORCE_COLOR:n,NODE_DISABLE_COLORS:i,NO_COLOR:s,TERM:a}=process.env||{},u=process.stdout&&process.stdout.isTTY);var c={enabled:!i&&null==s&&"dumb"!==a&&(null!=n&&"0"!==n||u)};function h(e,t){let r=RegExp(`\\x1b\\[${t}m`,"g"),n=`\x1b[${e}m`,i=`\x1b[${t}m`;return function(e){return c.enabled&&null!=e?n+(~(""+e).indexOf(i)?e.replace(r,i+n):e)+i:e}}var p=h(0,0),m=h(1,22),d=h(2,22),f=h(3,23),g=h(4,24),y=h(7,27),w=h(8,28),E=h(9,29),v=h(30,39),T=h(31,39),b=h(32,39),I=h(33,39),_=h(34,39),N=h(35,39),x=h(36,39),R=h(37,39),O=h(90,39),k=h(90,39),S=h(40,49),D=h(41,49),A=h(42,49),B=h(43,49),C=h(44,49),L=h(45,49),U=h(46,49),q=h(47,49),P=["green","yellow","blue","magenta","cyan","red"],G=[],$=Date.now(),M=0,j="undefined"!=typeof process?process.env:{};globalThis.DEBUG??=j.DEBUG??"",globalThis.DEBUG_COLORS??=!j.DEBUG_COLORS||"true"===j.DEBUG_COLORS;var W={enable(e){"string"==typeof e&&(globalThis.DEBUG=e)},disable(){let e=globalThis.DEBUG;return globalThis.DEBUG="",e},enabled(e){let t=globalThis.DEBUG.split(",").map(e=>e.replace(/[.+?^${}()|[\]\\]/g,"\\$&")),r=t.some(t=>""!==t&&"-"!==t[0]&&e.match(RegExp(t.split("*").join(".*")+"$"))),n=t.some(t=>""!==t&&"-"===t[0]&&e.match(RegExp(t.slice(1).split("*").join(".*")+"$")));return r&&!n},log:(...e)=>{let[t,r,...n]=e;(console.warn??console.log)(`${t} ${r}`,...n)},formatters:{}},F=new Proxy(function(e){let t={color:P[M++%P.length],enabled:W.enabled(e),namespace:e,log:W.log,extend:()=>{}};return new Proxy((...e)=>{let{enabled:r,namespace:n,color:i,log:s}=t;if(0!==e.length&&G.push([n,...e]),G.length>100&&G.shift(),W.enabled(n)||r){let t=e.map(e=>"string"==typeof e?e:function(e,t=2){let r=new Set;return JSON.stringify(e,(e,t)=>{if("object"==typeof t&&null!==t){if(r.has(t))return"[Circular *]";r.add(t)}else if("bigint"==typeof t)return t.toString();return t},t)}(e)),r=`+${Date.now()-$}ms`;$=Date.now(),globalThis.DEBUG_COLORS?s(l[i](m(n)),...t,l[i](r)):s(n,...t,r)}},{get:(e,r)=>t[r],set:(e,r,n)=>t[r]=n})},{get:(e,t)=>W[t],set:(e,t,r)=>W[t]=r}),Q=class extends Error{name="DriverAdapterError";cause;constructor(e){super("string"==typeof e.message?e.message:e.kind),this.cause=e}};function V(e){return{ok:!1,error:e,map:()=>V(e),flatMap:()=>V(e)}}var Y=F("driver-adapter-utils");function H(e,t){return async(...r)=>{try{return function e(t){return{ok:!0,value:t,map:r=>e(r(t)),flatMap:e=>e(t)}}(await t(...r))}catch(t){var n;if(Y("[error@wrapAsync]",t),"DriverAdapterError"===(n=t).name&&"object"==typeof n.cause)return V(t.cause);return V({kind:"GenericJs",id:e.registerNewError(t)})}}}var J={Int32:0,Int64:1,Float:2,Double:3,Numeric:4,Boolean:5,Text:7,Date:8,Time:9,DateTime:10,Json:11,Bytes:13,UnknownNumber:128},K=(Error("Not implemented: queryRaw"),Error("Not implemented: executeRaw"),Error("Not implemented: startTransaction"),Error("Not implemented: executeScript"),Error("Not implemented: dispose"),r(87550));Error("timeout while waiting for mutex to become available"),Error("mutex already locked");var Z=Error("request for lock canceled"),z=class{constructor(e,t=Z){this._value=e,this._cancelError=t,this._queue=[],this._weightedWaiters=[]}acquire(e=1,t=0){if(e<=0)throw Error(`invalid weight ${e}: must be positive`);return new Promise((r,n)=>{let i={resolve:r,reject:n,weight:e,priority:t},s=X(this._queue,e=>t<=e.priority);-1===s&&e<=this._value?this._dispatchItem(i):this._queue.splice(s+1,0,i)})}runExclusive(e){var t,r,n,i;return t=this,r=arguments,n=void 0,i=function*(e,t=1,r=0){let[n,i]=yield this.acquire(t,r);try{return yield e(n)}finally{i()}},new(n||(n=Promise))(function(e,s){function a(e){try{l(i.next(e))}catch(e){s(e)}}function o(e){try{l(i.throw(e))}catch(e){s(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof n?r:new n(function(e){e(r)})).then(a,o)}l((i=i.apply(t,r||[])).next())})}waitForUnlock(e=1,t=0){if(e<=0)throw Error(`invalid weight ${e}: must be positive`);return this._couldLockImmediately(e,t)?Promise.resolve():new Promise(r=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),function(e,t){let r=X(e,e=>t.priority<=e.priority);e.splice(r+1,0,t)}(this._weightedWaiters[e-1],{resolve:r,priority:t})})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatchQueue()}release(e=1){if(e<=0)throw Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatchQueue()}cancel(){this._queue.forEach(e=>e.reject(this._cancelError)),this._queue=[]}_dispatchQueue(){for(this._drainUnlockWaiters();this._queue.length>0&&this._queue[0].weight<=this._value;)this._dispatchItem(this._queue.shift()),this._drainUnlockWaiters()}_dispatchItem(e){let t=this._value;this._value-=e.weight,e.resolve([t,this._newReleaser(e.weight)])}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){if(0===this._queue.length)for(let e=this._value;e>0;e--){let t=this._weightedWaiters[e-1];t&&(t.forEach(e=>e.resolve()),this._weightedWaiters[e-1]=[])}else{let e=this._queue[0].priority;for(let t=this._value;t>0;t--){let r=this._weightedWaiters[t-1];if(!r)continue;let n=r.findIndex(t=>t.priority<=e);(-1===n?r:r.splice(0,n)).forEach(e=>e.resolve())}}}_couldLockImmediately(e,t){return(0===this._queue.length||this._queue[0].priority<t)&&e<=this._value}};function X(e,t){for(let r=e.length-1;r>=0;r--)if(t(e[r]))return r;return -1}var ee=class{constructor(e){this._semaphore=new z(1,e)}acquire(){var e,t,r,n;return e=this,t=arguments,r=void 0,n=function*(e=0){let[,t]=yield this._semaphore.acquire(1,e);return t},new(r||(r=Promise))(function(i,s){function a(e){try{l(n.next(e))}catch(e){s(e)}}function o(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})}runExclusive(e,t=0){return this._semaphore.runExclusive(()=>e(),1,t)}isLocked(){return this._semaphore.isLocked()}waitForUnlock(e=0){return this._semaphore.waitForUnlock(1,e)}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}},et="@prisma/adapter-better-sqlite3",er=F("prisma:driver-adapter:better-sqlite3:conversion"),en=class extends Error{name="UnexpectedTypeError";constructor(e){let t=typeof e;super(`unexpected value of type ${t}: ${"object"===t?JSON.stringify(e):String(e)}`)}};function ei(e,t,r){if(null===e)return null;if("string"==typeof e&&"int"===t.scalarType)return Number.parseInt(e);if("string"==typeof e&&"float"===t.scalarType||"string"==typeof e&&"decimal"===t.scalarType)return Number.parseFloat(e);if("string"==typeof e&&"bigint"===t.scalarType)return BigInt(e);if("boolean"==typeof e)return e?1:0;if("string"==typeof e&&"datetime"===t.scalarType&&(e=new Date(e)),e instanceof Date){let t=r?.timestampFormat??"iso8601";switch(t){case"unixepoch-ms":return e.getTime();case"iso8601":return e.toISOString().replace("Z","+00:00");default:throw Error(`Unknown timestamp format: ${t}`)}}return"string"==typeof e&&"bytes"===t.scalarType?Buffer.from(e,"base64"):e}var es=F("prisma:driver-adapter:better-sqlite3"),ea=class{constructor(e,t){this.client=e,this.adapterOptions=t}provider="sqlite";adapterName=et;async queryRaw(e){es("[js::queryRaw] %O",e);let{columnNames:t,declaredTypes:r,values:n}=await this.performIO(e),i=function(e,t){let[r,n]=function(e){let t=new Set;return[e.map((e,r)=>{let n=function(e){if(null===e)return null;switch(e.toUpperCase()){case"":return null;case"DECIMAL":return J.Numeric;case"FLOAT":return J.Float;case"DOUBLE":case"DOUBLE PRECISION":case"NUMERIC":case"REAL":return J.Double;case"TINYINT":case"SMALLINT":case"MEDIUMINT":case"INT":case"INTEGER":case"SERIAL":case"INT2":return J.Int32;case"BIGINT":case"UNSIGNED BIG INT":case"INT8":return J.Int64;case"DATETIME":case"TIMESTAMP":return J.DateTime;case"TIME":return J.Time;case"DATE":return J.Date;case"TEXT":case"CLOB":case"CHARACTER":case"VARCHAR":case"VARYING CHARACTER":case"NCHAR":case"NATIVE CHARACTER":case"NVARCHAR":return J.Text;case"BLOB":return J.Bytes;case"BOOLEAN":return J.Boolean;case"JSONB":return J.Json;default:return er("unknown decltype:",e),null}}(e);return null===n&&t.add(r),n}),t]}(e);if(0===n.size)return r;e:for(let e of n){for(let n=0;n<t.length;n++){let i=t[n][e];if(null!==i){r[e]=function(e){switch(typeof e){case"string":return J.Text;case"bigint":return J.Int64;case"boolean":return J.Boolean;case"number":return J.UnknownNumber;case"object":return function(e){if(e instanceof ArrayBuffer)return J.Bytes;throw new en(e)}(e);default:throw new en(e)}}(i);continue e}}r[e]=J.Int32}return r}(r,n);return{columnNames:t,columnTypes:i,rows:n.map(e=>(function(e,t){let r=[];for(let n=0;n<e.length;n++){let i=e[n];if("number"==typeof i&&(t[n]===J.Int32||t[n]===J.Int64)&&!Number.isInteger(i)){r[n]=Math.trunc(i);continue}if(["number","bigint"].includes(typeof i)&&t[n]===J.DateTime){r[n]=new Date(Number(i)).toISOString();continue}if("bigint"==typeof i){r[n]=i.toString();continue}r[n]=i}return r})(e,i))}}async executeRaw(e){return es("[js::executeRaw] %O",e),(await this.executeIO(e)).changes}executeIO(e){try{let t=e.args.map((t,r)=>ei(t,e.argTypes[r],this.adapterOptions)),r=this.client.prepare(e.sql).bind(t).run();return Promise.resolve(r)}catch(e){this.onError(e)}}performIO(e){try{let t=e.args.map((t,r)=>ei(t,e.argTypes[r],this.adapterOptions)),r=this.client.prepare(e.sql).bind(t);if(!r.reader)return r.run(),Promise.resolve({columnNames:[],declaredTypes:[],values:[]});let n=r.columns(),i={declaredTypes:n.map(e=>e.type),columnNames:n.map(e=>e.name),values:r.raw().all()};return Promise.resolve(i)}catch(e){this.onError(e)}}onError(e){throw es("Error in performIO: %O",e),new Q(function(e){if("string"==typeof e.code&&"string"==typeof e.message)return{originalCode:e.code,originalMessage:e.message,...function(e){switch(e.code){case"SQLITE_BUSY":return{kind:"SocketTimeout"};case"SQLITE_CONSTRAINT_UNIQUE":case"SQLITE_CONSTRAINT_PRIMARYKEY":{let t=e.message.split("constraint failed: ").at(1)?.split(", ").map(e=>e.split(".").pop());return{kind:"UniqueConstraintViolation",constraint:void 0!==t?{fields:t}:void 0}}case"SQLITE_CONSTRAINT_NOTNULL":{let t=e.message.split("constraint failed: ").at(1)?.split(", ").map(e=>e.split(".").pop());return{kind:"NullConstraintViolation",constraint:void 0!==t?{fields:t}:void 0}}case"SQLITE_CONSTRAINT_FOREIGNKEY":case"SQLITE_CONSTRAINT_TRIGGER":return{kind:"ForeignKeyConstraintViolation",constraint:{foreignKey:{}}};default:if(e.message.startsWith("no such table"))return{kind:"TableDoesNotExist",table:e.message.split(": ").at(1)};if(e.message.startsWith("no such column"))return{kind:"ColumnNotFound",column:e.message.split(": ").at(1)};if(e.message.includes("has no column named "))return{kind:"ColumnNotFound",column:e.message.split("has no column named ").at(1)};throw e}}(e)};throw e}(e))}},eo=class extends ea{constructor(e,t,r,n){super(e,r),this.options=t,this.#e=n}#e;commit(){return es("[js::commit]"),this.#e(),Promise.resolve()}rollback(){return es("[js::rollback]"),this.#e(),Promise.resolve()}},el=class extends ea{#t=new ee;constructor(e,t){super(e,t)}executeScript(e){try{this.client.exec(e)}catch(e){this.onError(e)}return Promise.resolve()}async startTransaction(e){if(e&&"SERIALIZABLE"!==e)throw new Q({kind:"InvalidIsolationLevel",level:e});let t={usePhantomQuery:!1};es("%s options: %O","[js::startTransaction]",t);try{let e=await this.#t.acquire();return this.client.prepare("BEGIN").run(),new eo(this.client,t,this.adapterOptions,e)}catch(e){this.onError(e)}}dispose(){return this.client.close(),Promise.resolve()}},eu=class{provider="sqlite";adapterName=et;#r;#n;constructor(e,t){this.#r=e,this.#n=t}connect(){return Promise.resolve(new el(ec(this.#r),this.#n))}connectToShadowDb(){let e=this.#n?.shadowDatabaseUrl??":memory:";return Promise.resolve(new el(ec({...this.#r,url:e}),this.#n))}};function ec(e){let{url:t,...r}=e,n=new K(t.replace(/^file:/,""),r);return n.defaultSafeIntegers(!0),n}}};