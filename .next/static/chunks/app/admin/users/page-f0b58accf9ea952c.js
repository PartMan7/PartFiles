(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8733],{92853:(e,t,a)=>{Promise.resolve().then(a.bind(a,98670)),Promise.resolve().then(a.bind(a,55277))},98867:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(63394).A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},40767:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(63394).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},49662:(e,t,a)=>{"use strict";a.d(t,{J:()=>r});var s=a(95155);function r(){return(0,s.jsx)("span",{"aria-hidden":"true",className:"text-destructive -ml-1.5 select-none",children:"*"})}},38002:(e,t,a)=>{"use strict";a.d(t,{Fc:()=>l,TN:()=>o});var s=a(95155);a(12115);var r=a(31027),n=a(21567);let i=(0,r.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:a,...r}=e;return(0,s.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,n.cn)(i({variant:a}),t),...r})}function o(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"alert-description",className:(0,n.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...a})}},51344:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>u,L3:()=>p,c7:()=>x,lG:()=>l,rr:()=>m,zM:()=>o});var s=a(95155);a(12115);var r=a(40767),n=a(66217),i=a(21567);function l(e){let{...t}=e;return(0,s.jsx)(n.Root,{"data-slot":"dialog",...t})}function o(e){let{...t}=e;return(0,s.jsx)(n.Trigger,{"data-slot":"dialog-trigger",...t})}function d(e){let{...t}=e;return(0,s.jsx)(n.Portal,{"data-slot":"dialog-portal",...t})}function c(e){let{className:t,...a}=e;return(0,s.jsx)(n.Overlay,{"data-slot":"dialog-overlay",className:(0,i.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function u(e){let{className:t,children:a,showCloseButton:l=!0,...o}=e;return(0,s.jsxs)(d,{"data-slot":"dialog-portal",children:[(0,s.jsx)(c,{}),(0,s.jsxs)(n.Content,{"data-slot":"dialog-content",className:(0,i.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 outline-none sm:max-w-lg",t),...o,children:[a,l&&(0,s.jsxs)(n.Close,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,s.jsx)(r.A,{}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function x(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"dialog-header",className:(0,i.cn)("flex flex-col gap-2 text-center sm:text-left",t),...a})}function p(e){let{className:t,...a}=e;return(0,s.jsx)(n.Title,{"data-slot":"dialog-title",className:(0,i.cn)("text-lg leading-none font-semibold",t),...a})}function m(e){let{className:t,...a}=e;return(0,s.jsx)(n.Description,{"data-slot":"dialog-description",className:(0,i.cn)("text-muted-foreground text-sm",t),...a})}a(73312)},33900:(e,t,a)=>{"use strict";a.d(t,{p:()=>n});var s=a(95155);a(12115);var r=a(21567);function n(e){let{className:t,type:a,...n}=e;return(0,s.jsx)("input",{type:a,"data-slot":"input",className:(0,r.cn)("placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive","file:border-0 file:bg-primary file:text-primary-foreground file:rounded-md file:px-3 file:text-sm file:font-medium file:cursor-pointer file:hover:bg-primary/90 file:transition-colors file:mr-3 file:-ml-3","file"===a&&"h-auto py-1.5 text-sm text-muted-foreground cursor-pointer",t),...n})}},98986:(e,t,a)=>{"use strict";a.d(t,{J:()=>i});var s=a(95155);a(12115);var r=a(46195),n=a(21567);function i(e){let{className:t,...a}=e;return(0,s.jsx)(r.Root,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}},87532:(e,t,a)=>{"use strict";a.d(t,{l6:()=>c,gC:()=>p,eb:()=>m,bq:()=>x,yv:()=>u});var s=a(95155);a(12115);var r=a(63394);let n=(0,r.A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);var i=a(98867);let l=(0,r.A)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var o=a(63409),d=a(21567);function c(e){let{...t}=e;return(0,s.jsx)(o.Root,{"data-slot":"select",...t})}function u(e){let{...t}=e;return(0,s.jsx)(o.Value,{"data-slot":"select-value",...t})}function x(e){let{className:t,size:a="default",children:r,...i}=e;return(0,s.jsxs)(o.Trigger,{"data-slot":"select-trigger","data-size":a,className:(0,d.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...i,children:[r,(0,s.jsx)(o.Icon,{asChild:!0,children:(0,s.jsx)(n,{className:"size-4 opacity-50"})})]})}function p(e){let{className:t,children:a,position:r="item-aligned",align:n="center",...i}=e;return(0,s.jsx)(o.Portal,{children:(0,s.jsxs)(o.Content,{"data-slot":"select-content",className:(0,d.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,align:n,...i,children:[(0,s.jsx)(h,{}),(0,s.jsx)(o.Viewport,{className:(0,d.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,s.jsx)(g,{})]})})}function m(e){let{className:t,children:a,...r}=e;return(0,s.jsxs)(o.Item,{"data-slot":"select-item",className:(0,d.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...r,children:[(0,s.jsx)("span",{"data-slot":"select-item-indicator",className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,s.jsx)(o.ItemIndicator,{children:(0,s.jsx)(i.A,{className:"size-4"})})}),(0,s.jsx)(o.ItemText,{children:a})]})}function h(e){let{className:t,...a}=e;return(0,s.jsx)(o.ScrollUpButton,{"data-slot":"select-scroll-up-button",className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(l,{className:"size-4"})})}function g(e){let{className:t,...a}=e;return(0,s.jsx)(o.ScrollDownButton,{"data-slot":"select-scroll-down-button",className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(n,{className:"size-4"})})}},72508:(e,t,a)=>{"use strict";a.d(t,{A0:()=>i,BF:()=>l,Hj:()=>o,XI:()=>n,nA:()=>c,nd:()=>d});var s=a(95155);a(12115);var r=a(21567);function n(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,s.jsx)("table",{"data-slot":"table",className:(0,r.cn)("w-full caption-bottom text-sm",t),...a})})}function i(e){let{className:t,...a}=e;return(0,s.jsx)("thead",{"data-slot":"table-header",className:(0,r.cn)("[&_tr]:border-b",t),...a})}function l(e){let{className:t,...a}=e;return(0,s.jsx)("tbody",{"data-slot":"table-body",className:(0,r.cn)("[&_tr:last-child]:border-0",t),...a})}function o(e){let{className:t,...a}=e;return(0,s.jsx)("tr",{"data-slot":"table-row",className:(0,r.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...a})}function d(e){let{className:t,...a}=e;return(0,s.jsx)("th",{"data-slot":"table-head",className:(0,r.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}function c(e){let{className:t,...a}=e;return(0,s.jsx)("td",{"data-slot":"table-cell",className:(0,r.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...a})}},55277:(e,t,a)=>{"use strict";a.d(t,{UserManager:()=>N});var s=a(95155),r=a(12115),n=a(73312),i=a(33900),l=a(98986),o=a(87532),d=a(72508),c=a(51344),u=a(31027),x=a(58629),p=a(21567);function m(e){let{className:t,orientation:a="horizontal",...r}=e;return(0,s.jsx)(x.Root,{"data-slot":"tabs","data-orientation":a,orientation:a,className:(0,p.cn)("group/tabs flex gap-2 data-[orientation=horizontal]:flex-col",t),...r})}let h=(0,u.F)("rounded-lg p-[3px] group-data-[orientation=horizontal]/tabs:h-9 data-[variant=line]:rounded-none group/tabs-list text-muted-foreground inline-flex w-fit items-center justify-center group-data-[orientation=vertical]/tabs:h-fit group-data-[orientation=vertical]/tabs:flex-col",{variants:{variant:{default:"bg-muted",line:"gap-1 bg-transparent"}},defaultVariants:{variant:"default"}});function g(e){let{className:t,variant:a="default",...r}=e;return(0,s.jsx)(x.List,{"data-slot":"tabs-list","data-variant":a,className:(0,p.cn)(h({variant:a}),t),...r})}function f(e){let{className:t,...a}=e;return(0,s.jsx)(x.Trigger,{"data-slot":"tabs-trigger",className:(0,p.cn)("focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring text-foreground/60 hover:text-foreground dark:text-muted-foreground dark:hover:text-foreground relative inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-all group-data-[orientation=vertical]/tabs:w-full group-data-[orientation=vertical]/tabs:justify-start focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 group-data-[variant=default]/tabs-list:data-[state=active]:shadow-sm group-data-[variant=line]/tabs-list:data-[state=active]:shadow-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4","group-data-[variant=line]/tabs-list:bg-transparent group-data-[variant=line]/tabs-list:data-[state=active]:bg-transparent dark:group-data-[variant=line]/tabs-list:data-[state=active]:border-transparent dark:group-data-[variant=line]/tabs-list:data-[state=active]:bg-transparent","data-[state=active]:bg-background dark:data-[state=active]:text-foreground dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 data-[state=active]:text-foreground","after:bg-foreground after:absolute after:opacity-0 after:transition-opacity group-data-[orientation=horizontal]/tabs:after:inset-x-0 group-data-[orientation=horizontal]/tabs:after:bottom-[-5px] group-data-[orientation=horizontal]/tabs:after:h-0.5 group-data-[orientation=vertical]/tabs:after:inset-y-0 group-data-[orientation=vertical]/tabs:after:-right-1 group-data-[orientation=vertical]/tabs:after:w-0.5 group-data-[variant=line]/tabs-list:data-[state=active]:after:opacity-100",t),...a})}function v(e){let{className:t,...a}=e;return(0,s.jsx)(x.Content,{"data-slot":"tabs-content",className:(0,p.cn)("flex-1 outline-none",t),...a})}var b=a(25121),j=a(38002),w=a(49662),y=a(30814);function N(e){let{currentUserId:t}=e,[a,i]=(0,r.useState)([]),[l,o]=(0,r.useState)(!0),[u,x]=(0,r.useState)(!1),[p,m]=(0,r.useState)(null),h=(0,r.useCallback)(async()=>{try{let e=await fetch("/api/admin/users"),t=await e.json();i(t.users||[])}catch(e){y.oR.error("Failed to load users")}finally{o(!1)}},[]);async function g(e){if(confirm('Delete user "'.concat(e.username,'"? This will also delete their content.')))try{let t=await fetch("/api/admin/users/".concat(e.id),{method:"DELETE"});if(t.ok)y.oR.success('User "'.concat(e.username,'" deleted')),h();else{let e=await t.json();y.oR.error(e.error||"Failed to delete user")}}catch(e){y.oR.error("Failed to delete user")}}return((0,r.useEffect)(()=>{h()},[h]),l)?(0,s.jsx)("p",{className:"text-muted-foreground",role:"status","aria-live":"polite",children:"Loading users..."}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("p",{className:"text-muted-foreground","aria-live":"polite",children:[a.length," user(s)"]}),(0,s.jsxs)(c.lG,{open:u,onOpenChange:x,children:[(0,s.jsx)(c.zM,{asChild:!0,children:(0,s.jsx)(n.$,{children:"Add User"})}),(0,s.jsxs)(c.Cf,{children:[(0,s.jsxs)(c.c7,{children:[(0,s.jsx)(c.L3,{children:"Create New User"}),(0,s.jsx)(c.rr,{children:"Add a new user to the system. Users cannot register themselves."})]}),(0,s.jsx)(k,{onSuccess:()=>{x(!1),h()}})]})]})]}),(0,s.jsxs)(d.XI,{"aria-label":"User accounts",children:[(0,s.jsx)(d.A0,{children:(0,s.jsxs)(d.Hj,{children:[(0,s.jsx)(d.nd,{children:"Username"}),(0,s.jsx)(d.nd,{children:"Role"}),(0,s.jsx)(d.nd,{children:"Content"}),(0,s.jsx)(d.nd,{children:"Created"}),(0,s.jsx)(d.nd,{className:"text-right",children:(0,s.jsx)("span",{className:"sr-only",children:"Actions"})})]})}),(0,s.jsx)(d.BF,{children:a.map(e=>(0,s.jsxs)(d.Hj,{children:[(0,s.jsx)(d.nA,{className:"font-medium",children:e.username}),(0,s.jsx)(d.nA,{children:(0,s.jsx)(b.E,{variant:"admin"===e.role?"default":"outline",children:e.role})}),(0,s.jsx)(d.nA,{children:e._count.content}),(0,s.jsx)(d.nA,{children:new Date(e.createdAt).toLocaleDateString()}),(0,s.jsxs)(d.nA,{className:"text-right space-x-2",children:[(0,s.jsxs)(c.lG,{open:(null==p?void 0:p.id)===e.id,onOpenChange:e=>!e&&m(null),children:[(0,s.jsx)(c.zM,{asChild:!0,children:(0,s.jsx)(n.$,{variant:"outline",size:"sm",onClick:()=>m(e),children:"Edit"})}),(0,s.jsxs)(c.Cf,{children:[(0,s.jsxs)(c.c7,{children:[(0,s.jsxs)(c.L3,{children:["Edit User: ",e.username]}),(0,s.jsx)(c.rr,{children:"Update user details."})]}),(0,s.jsx)(C,{user:e,onSuccess:()=>{m(null),h()}})]})]}),e.id!==t&&(0,s.jsx)(n.$,{variant:"destructive",size:"sm",onClick:()=>g(e),children:"Delete"})]})]},e.id))})]})]})}function k(e){let{onSuccess:t}=e,[a,d]=(0,r.useState)(""),[c,u]=(0,r.useState)(!1),[x,p]=(0,r.useState)("guest"),[h,b]=(0,r.useState)("password"),[N,k]=(0,r.useState)(""),[C,z]=(0,r.useState)(!1);async function S(e){e.preventDefault(),d(""),u(!0),k("");let a=new FormData(e.currentTarget),s={username:a.get("username"),role:x};"invite"===h?s.invite=!0:s.password=a.get("password");try{let e=await fetch("/api/admin/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),a=await e.json();e.ok?"invite"===h&&a.inviteUrl?(k(a.inviteUrl),y.oR.success('User "'.concat(a.user.username,'" created with invite link'))):(y.oR.success('User "'.concat(a.user.username,'" created')),t()):d(a.error||"Failed to create user")}catch(e){d("An error occurred")}finally{u(!1)}}return N?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(j.Fc,{children:(0,s.jsx)(j.TN,{children:"User created! Share this one-time invite link. It expires in 48 hours."})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.J,{children:"Invite Link"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(i.p,{value:N,readOnly:!0,className:"font-mono text-xs"}),(0,s.jsx)(n.$,{type:"button",variant:"outline",onClick:function(){navigator.clipboard.writeText(N),z(!0),y.oR.success("Invite link copied to clipboard"),setTimeout(()=>z(!1),2e3)},className:"shrink-0",children:C?"Copied!":"Copy"})]})]}),(0,s.jsx)(n.$,{className:"w-full",onClick:t,children:"Done"})]}):(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsxs)(m,{value:h,onValueChange:e=>b(e),children:[(0,s.jsxs)(g,{className:"w-full",children:[(0,s.jsx)(f,{value:"password",className:"flex-1",children:"Set Password"}),(0,s.jsx)(f,{value:"invite",className:"flex-1",children:"Invite Link"})]}),(0,s.jsxs)("form",{onSubmit:S,className:"space-y-4 pt-4","aria-label":"Create new user",children:[(0,s.jsx)("div",{"aria-live":"assertive","aria-atomic":"true",children:a&&(0,s.jsx)(j.Fc,{variant:"destructive",children:(0,s.jsx)(j.TN,{children:a})})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(l.J,{htmlFor:"new-username",children:["Username",(0,s.jsx)(w.J,{})]}),(0,s.jsx)(i.p,{id:"new-username",name:"username",required:!0,minLength:3,maxLength:50,"aria-required":"true"})]}),(0,s.jsx)(v,{value:"password",className:"mt-0",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(l.J,{htmlFor:"new-password",children:["Password",(0,s.jsx)(w.J,{})]}),(0,s.jsx)(i.p,{id:"new-password",name:"password",type:"password",required:"password"===h,minLength:8,"aria-required":"password"===h})]})}),(0,s.jsx)(v,{value:"invite",className:"mt-0",children:(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"A one-time link will be generated. The new user will set their own password â€” you will never see it."})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(l.J,{children:["Role",(0,s.jsx)(w.J,{})]}),(0,s.jsxs)(o.l6,{value:x,onValueChange:p,required:!0,children:[(0,s.jsx)(o.bq,{"aria-label":"Select role","aria-required":"true",children:(0,s.jsx)(o.yv,{})}),(0,s.jsxs)(o.gC,{children:[(0,s.jsx)(o.eb,{value:"guest",children:"Guest"}),(0,s.jsx)(o.eb,{value:"uploader",children:"Uploader"}),(0,s.jsx)(o.eb,{value:"admin",children:"Admin"})]})]})]}),(0,s.jsx)(n.$,{type:"submit",className:"w-full",disabled:c,"aria-busy":c,children:c?"Creating...":"invite"===h?"Create User & Generate Link":"Create User"})]})]})})}function C(e){let{user:t,onSuccess:a}=e,[d,c]=(0,r.useState)(""),[u,x]=(0,r.useState)(!1),[p,m]=(0,r.useState)(t.role);async function h(e){e.preventDefault(),c(""),x(!0);let s=new FormData(e.currentTarget),r=s.get("password"),n=s.get("username"),i={role:p};n&&n!==t.username&&(i.username=n),r&&(i.password=r);try{let e=await fetch("/api/admin/users/".concat(t.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}),s=await e.json();e.ok?(y.oR.success("User updated"),a()):c(s.error||"Failed to update user")}catch(e){c("An error occurred")}finally{x(!1)}}return(0,s.jsxs)("form",{onSubmit:h,className:"space-y-4","aria-label":"Edit user ".concat(t.username),children:[(0,s.jsx)("div",{"aria-live":"assertive","aria-atomic":"true",children:d&&(0,s.jsx)(j.Fc,{variant:"destructive",children:(0,s.jsx)(j.TN,{children:d})})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.J,{htmlFor:"edit-username",children:"Username"}),(0,s.jsx)(i.p,{id:"edit-username",name:"username",defaultValue:t.username,minLength:3,maxLength:50})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.J,{htmlFor:"edit-password",children:"New Password"}),(0,s.jsx)(i.p,{id:"edit-password",name:"password",type:"password",minLength:8,placeholder:"Leave blank to keep current"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(l.J,{children:["Role",(0,s.jsx)(w.J,{})]}),(0,s.jsxs)(o.l6,{value:p,onValueChange:m,required:!0,children:[(0,s.jsx)(o.bq,{"aria-label":"Select role","aria-required":"true",children:(0,s.jsx)(o.yv,{})}),(0,s.jsxs)(o.gC,{children:[(0,s.jsx)(o.eb,{value:"guest",children:"Guest"}),(0,s.jsx)(o.eb,{value:"uploader",children:"Uploader"}),(0,s.jsx)(o.eb,{value:"admin",children:"Admin"})]})]})]}),(0,s.jsx)(n.$,{type:"submit",className:"w-full",disabled:u,"aria-busy":u,children:u?"Saving...":"Save Changes"})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[9247,4822,3455,7250,814,3409,3131,8670,8441,1517,7358],()=>t(92853)),_N_E=e.O()}]);